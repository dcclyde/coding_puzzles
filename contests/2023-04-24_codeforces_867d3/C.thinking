
4 <= N <= 1e9

Think about the edges separately.
For interior, we have
4   10
5   14
6   prev + 9?

2N


4   10
5   17      7
6   26      9

...
N   10*(N-3) + (7 + 9 + 11 + ... + (2N-3))

    10*N + 7*(N-4) + (0 + 2 + 4 + ... + (2N-10))

    17*N + 2 * (1+2+... + (N-5))

.
